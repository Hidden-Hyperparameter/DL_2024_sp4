/root/DL_2024_sp4/generation
batch size 64
length 23
out.shape torch.Size([64, 23, 512])
c.shape torch.Size([12, 64, 512])
h_in.shape torch.Size([6, 64, 512])
c_in.shape torch.Size([6, 64, 512])
torch.Size([64, 23])
tensor([[   0,  137, 2165,  ...,    1,    1,    1],
        [   0,  612,  186,  ...,    1,    1,    1],
        [   0,  831, 1892,  ...,    1,    1,    1],
        ...,
        [   0,  215,  453,  ...,    1,    1,    1],
        [   0,  532, 1346,  ...,    1,    1,    1],
        [   0, 2499,  627,  ...,    1,    1,    1]], device='cuda:0')
torch.Size([64, 23, 512])
prev_embedded tensor([[[-6.7409e-03,  2.4247e-03,  1.2824e-02,  ...,  9.3937e-03,
          -1.0334e-02, -8.6628e-04],
         [-7.4000e-04,  5.0829e-04,  1.5122e-02,  ...,  1.7616e-02,
          -3.4930e-03,  4.9830e-03],
         [-4.5503e-03, -2.7558e-03, -9.2648e-05,  ..., -2.1306e-04,
           4.0978e-03,  3.7042e-03],
         ...,
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03],
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03],
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03]],

        [[-6.7409e-03,  2.4247e-03,  1.2824e-02,  ...,  9.3937e-03,
          -1.0334e-02, -8.6628e-04],
         [-4.9592e-03, -4.4664e-04,  1.0957e-02,  ...,  1.3801e-02,
          -9.1925e-03, -2.0883e-03],
         [-2.7083e-03, -1.1939e-02,  5.7470e-03,  ...,  3.1838e-03,
          -8.1412e-03, -2.8014e-03],
         ...,
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03],
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03],
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03]],

        [[-6.7409e-03,  2.4247e-03,  1.2824e-02,  ...,  9.3937e-03,
          -1.0334e-02, -8.6628e-04],
         [ 1.1211e-02, -7.6048e-03,  1.1858e-02,  ...,  1.6492e-02,
           1.7869e-03, -1.0324e-02],
         [ 9.9581e-03,  1.3385e-03,  5.9150e-03,  ...,  1.3664e-02,
          -1.3627e-02, -3.7915e-04],
         ...,
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03],
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03],
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03]],

        ...,

        [[-6.7409e-03,  2.4247e-03,  1.2824e-02,  ...,  9.3937e-03,
          -1.0334e-02, -8.6628e-04],
         [-1.9582e-03,  2.7022e-03,  4.6577e-03,  ...,  4.3982e-03,
          -2.8512e-03, -6.8067e-03],
         [ 7.5389e-03, -6.2613e-03,  1.3177e-02,  ...,  2.3496e-03,
          -3.4189e-03, -1.5477e-03],
         ...,
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03],
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03],
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03]],

        [[-6.7409e-03,  2.4247e-03,  1.2824e-02,  ...,  9.3937e-03,
          -1.0334e-02, -8.6628e-04],
         [ 7.0721e-03, -3.1463e-03,  9.7941e-03,  ..., -1.4415e-03,
          -5.6706e-03, -1.1533e-02],
         [ 1.2934e-02, -8.3346e-03,  7.1682e-03,  ...,  1.2702e-02,
          -8.8929e-03, -3.2784e-05],
         ...,
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03],
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03],
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03]],

        [[-6.7409e-03,  2.4247e-03,  1.2824e-02,  ...,  9.3937e-03,
          -1.0334e-02, -8.6628e-04],
         [ 9.6282e-03, -2.1342e-03,  9.0438e-03,  ...,  1.4963e-02,
          -1.3556e-02, -1.4158e-04],
         [ 8.4815e-04, -1.4409e-02,  4.4648e-03,  ...,  1.8172e-02,
          -1.7095e-03, -1.2433e-02],
         ...,
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03],
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03],
         [-3.5198e-03,  4.3144e-03,  9.7178e-03,  ...,  1.6794e-02,
          -5.8035e-03, -2.7069e-03]]], device='cuda:0',
       grad_fn=<ViewBackward0>)
final_out.shape torch.Size([64, 23, 512])
prev_outputs.shape torch.Size([64, 23, 512])
tensor([[[ 0.0126,  0.0051, -0.0088,  ..., -0.0247, -0.0243, -0.0007],
         [ 0.0142,  0.0057,  0.0018,  ..., -0.0206, -0.0206, -0.0040],
         [ 0.0154,  0.0070,  0.0060,  ..., -0.0192, -0.0175, -0.0068],
         ...,
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146],
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146],
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146]],

        [[ 0.0126,  0.0051, -0.0088,  ..., -0.0247, -0.0244, -0.0007],
         [ 0.0142,  0.0057,  0.0018,  ..., -0.0206, -0.0206, -0.0040],
         [ 0.0154,  0.0070,  0.0060,  ..., -0.0192, -0.0175, -0.0068],
         ...,
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146],
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146],
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146]],

        [[ 0.0126,  0.0051, -0.0088,  ..., -0.0247, -0.0243, -0.0007],
         [ 0.0142,  0.0057,  0.0018,  ..., -0.0206, -0.0206, -0.0040],
         [ 0.0154,  0.0070,  0.0060,  ..., -0.0192, -0.0175, -0.0068],
         ...,
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146],
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146],
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146]],

        ...,

        [[ 0.0126,  0.0051, -0.0088,  ..., -0.0246, -0.0243, -0.0007],
         [ 0.0141,  0.0057,  0.0018,  ..., -0.0206, -0.0206, -0.0040],
         [ 0.0154,  0.0070,  0.0060,  ..., -0.0192, -0.0175, -0.0068],
         ...,
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146],
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146],
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146]],

        [[ 0.0126,  0.0051, -0.0088,  ..., -0.0246, -0.0243, -0.0007],
         [ 0.0141,  0.0057,  0.0018,  ..., -0.0205, -0.0206, -0.0040],
         [ 0.0154,  0.0070,  0.0060,  ..., -0.0192, -0.0175, -0.0068],
         ...,
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146],
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146],
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146]],

        [[ 0.0126,  0.0051, -0.0088,  ..., -0.0247, -0.0244, -0.0006],
         [ 0.0142,  0.0057,  0.0018,  ..., -0.0206, -0.0206, -0.0040],
         [ 0.0154,  0.0070,  0.0060,  ..., -0.0192, -0.0175, -0.0068],
         ...,
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146],
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146],
         [ 0.0183,  0.0092,  0.0053,  ..., -0.0226, -0.0156, -0.0146]]],
       device='cuda:0', grad_fn=<CudnnRnnBackward0>)
